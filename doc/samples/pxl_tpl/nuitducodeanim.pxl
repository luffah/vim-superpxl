"{% head %}
  tabnew | call render#Dj_playAnimation(expand('<sfile>'))
  finish
  " License is CC-0 public domain

  " Source this file to play animation
  " so %
"{% end head %}
{% subst %}
" the first part can contain substitutions which will be applied to each line
s/\(HH:MM:SS\)/{{ '\1' {<<} b:hour }}/
{% end subst %}
 7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777 
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777FFFFFFF7777777777FFF7777777777777777777777777777777777777777777777777777FFF777777777777777777777777777
777F0FFF0F7777777777F0F7777777777FFF7777777777777777777777FFF77777777777777F0F777777777777777777777777777
777F00FF0F7777777FFFF0FF777777777F0F7777777777777777777777F0F77777777777FFFF0FF77777777777777777777777777
777F0F0F0FFFFFFF7F0FF00F7777777FFF0FFFFFFF7777FFFF7FFFF7FFF0FFFFF777FFFFF0FF00F77FFFFFFF7FFFFFFFFFFFF7777
777F0F0F0FF0FF0F7FFFF0FFFFF777FF000FF0FF0F777FF00FFF00FFF000FF00F77FF00FFFFF0FFFFF00FF0FFF0FF00FF0F0FF777
777F0FF00FF0FF0F7F0FF0FFF0F777F0FFFFF0FF0F777F0FFFF0FF0F0FFFF000F77F0FFFF0FF0FF0F0FF0FF0F0FF000FF00F0F777
777F0FFF0FFF00F0FF0FFF000FF777FF00F7FF00F0F77FF00FFF00FFF00FFF0FF77FF00FF0FFF00FFF00FFFF0FFFF0FFF0FF0F777
777FFF7FFF7FFFFFFFFF7FFFFF77777FFFF77FFFFF7777FFFF7FFFF7FFFF7FFF7777FFFFFFF7FFFF7FFFFFF0FF77FFF7FFFFFF777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777F0FF7777777777777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777FFF77777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
 7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777 
  7777FFFFFFFFFFFFFFFFFFFFFFFFFFF...............F................................................7777
    777FFFFFFFFFFFFFFFFFFFFFFFFFF\Heure : HH:MM:SS\..............................................777
{% code %}
" Animation example (note the  { { and } } shall clearly delimit the code from the image)
" The code that will be launched 
" b:colortab contains color chars 9 -> red, A -> green...
" we exclude 0 and F which are used for the text part
let b:colortab=['6','7','8','9','A','B','C','D','E']
let b:nbcolors=len(b:colortab)

" Clear the colors like that
" 1,22s/[123456789ABCDE]/7/g | noh

" Proceed the animation
let b:nbl=22
try
 for b:j in ['7','8','4','5','D']
   " Clear
   silent exe '1,'.b:nbl.'s/[123456789ABCDE]/'.b:j.'/g'
   redraw
   " Fill randomly
   for b:i in range(0,220)
     for b:k in range(0,9)
       silent! exe (bot#getRandom(b:nbl)+1).'s/'.b:j.'/'.b:colortab[bot#getRandom(b:nbcolors)].'/'
       sleep 10m
     endfor
     let b:hour = strftime("%T",localtime())
     call render#Dj_update(b:updater)
     redraw
     let l:ch=getchar(0)
     if l:ch
       let l:ch = nr2char(l:ch)
       if l:ch == 'q'
         throw 'quit'
       elseif l:ch == 'n'
         break
       elseif l:ch =~ '\x'
         let b:j=toupper(l:ch)
         let b:nbl=23
         silent exe '1,'.b:nbl.'s/[123456789ABCDE]/'.b:j.'/g'
         redraw
       endif
     endif
   endfor
 endfor
catch
 echo 'quit'
endtry

" Quit
q
{% end code %}
